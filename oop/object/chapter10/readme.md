OBJECT Chapter10 - 상속과 코드 재사용
--
전통적인 패러다임에서는 코드를 재사용하기 위해 '복사' 하고 수정해왔다.  
객체지향에서는 코드를 재사용하기 위해 ‘새로운’ 코드를 추가한다.  

그 방법으로 상속과 합성이 존재한다.

### 상속과 중복코드

#### DRY 원칙- Don’t Repeat Yourself

중복 코드는 변경을 방해한다.  
이것이 중복 코드를 제거해야 하는 가장 큰 이유다.   
비즈니스 지식은 항상 변한다. 새로운 코드를 추가하고 나면 언젠 가는 변경될 것이라고 생각하는 것이 현명하다.

**중복코드의 문제점**  
변경이 생기면 중복된 코드를 같이 변경해야한다. 변경 후 테스트 및 검증도 각각 해야한다.  
중복은 수정에 대한 비용을 몇배나 증가 시키는 셈이다.  

중복 여부를 판단하는 기준은 변경이다.  
요구사항이 변경됐을 때 두 코드를 함께 수정해야 한다면 이 코드는 중복이다.  
함께 수정할 필요가 없다면 중복이 아나다.  

**기준은 코드의 모양이 아니다. 코드가 변경에 반응하는 방식이다**

코드 재사용을 막는 다양한 방법들을 살펴보자.  

#### 타입코드 사용하기
중복되는 코드를 지닌 클래스를 하나로 합치고 타입 필드를 추가하는 방법.  
하지만 타입 코드를 사용하는 클래스는 낮은 응집도와 높은 결합도라는 문제에 시달리게 된다.    
여러 책임이 있다는 반증이 되기 때문.  

#### 상속을 이용해서 중복 코드 제거하기
상속을 이용해 코드를 재시용하기 위해서는 부모 클래스의 개발자가 세웠던 가정이나 추론 과정을 정확하게 이해해야 한다.
무분별한 상속은 많은 문제점을 야기한다.  

- **상속은 결합도를 높인다.**  
자식 클래스의 메서드 안에서 super 참조를 이용해 부모 클래스의 메서드를 직접 호출할 경우  
두 클래스는 강하게 결합된다. super 호출을 제거할 수 있는 방법을 찾아 결합도를 제거하랴.

- **취약한 기반 클래스 문제**  
부모 클래스의 변경에 의해 자식 클래스가 영향을 받는 현상을 취약한 기반 클래스 문제라고 부른다.     
이 문제는 상속을 사용한다면 피할수 없는 객체지향프로그래밍의 근본적인 취약성이다.

- **불필요한 인터페이스 상속 문제**
인터페이스 설계는 제대로 쓰기엔 쉽게 엉터리로 쓰기엔 어렵게 만들어야 한다.  
단순히 코드를 재 사용하기 위해 불필요한 오퍼레이션이 인터페이스에 스며들도록 방치해서는 안 된다.  
상속받은 부모 클래스의 인터페이스가 자식 클래스의 내부 구조에 대한 규칙을 깨트릴 수 있다.    
Stack 클래스는 Vector 를 상속받는다.  
하지만 Vector 의 메서드에는 중간의 원소들을 가져오거나 변경하는 메서드가 있어 LIFO 구조의 Stack의 규칙을 깰 수 있었다.   
  

> Effective Java 의 저자 조슈아 블로치는  
> 클래스가 상속되기를 원한다면 상속을 위해 클래스를 설계하고 문서화해야 하며，   
> 그렇지 않은 경우에는 상속을 금지시켜야 한다고 주장한다.



클래스를 상속하면 결합도로 인해 지식 클래스와 부모 클래스의 구현을 영원히 변경하지 않거나   
자식 클래스와 부모 클래스를 동시에 변경하거나 둘 중 하나를 선택할 수 밖에 없다.  

상속의 문제점을 살펴보았으니, 그 문제점을 최소화하는 2가지 원칙을 살펴보자.

- **차이를 메서드로 추출하라**  
**“변하는 것으로부터 변하지 않는 것을 분리하라”** 메서드 수준에서 적용한 것이다.
  
- **부모 클래스로 올려라**  
부모 클래스의 구체적인 코드를 하위로 내리기보다는 자식 클래스의 추상적인 메서드를 부모 클래스로 올려라.

#### 역시나 추상화가 핵심이다
차이를 메서드로 추출하고, 공통되는 부분은 부모의 콘크리트 메서드로 올려라.   
추출한 차이는 부모클래스의 추상메서드로 만들자.    

상속에서도 마찬가지, 모든 클래스가 추상화에 의존하도록 만들어라.    
추상화를 찾아내고 상속 계층 안의 클래스들이 그 추상화에 의존하도록 코드를 리팩터링하라.   
차이점을 메서드로 추출하고 공통적인 부분은 부모 클래스로 이동 하라.  

#### 의도를 드러내는 이름 선택하기
상속하는 클래스들이 어떤 내용을 구현하는지 이름을 통하여 명시적으로 드러내라.  

10장에서는 상속은 강력하지만, 얼마나 위험한지 알 수 있게 되었다.  
상속의 남용은 어플리케이션을 이해하기 힘들고, 확장하기 힘들게 만든다.  
정말로 필요한곳에만 상속을 사용하자.